<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Tickets Management - Helpdesk Admin</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#254798",
                        secondary: "#EFF3FC",
                        "background-light": "#F3F5FA",
                        "background-dark": "#0F172A",
                        "surface-light": "#FFFFFF",
                        "surface-dark": "#1E293B",
                        "text-main-light": "#111827",
                        "text-main-dark": "#F9FAFB",
                        "text-sub-light": "#6B7280",
                        "text-sub-dark": "#9CA3AF",
                    },
                    fontFamily: {
                        display: ["Inter", "sans-serif"],
                    },
                },
            },
        };
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark text-text-main-light dark:text-text-main-dark h-screen overflow-hidden flex">
    <!-- Sidebar -->
    <aside
        class="w-64 bg-surface-light dark:bg-surface-dark border-r border-gray-200 dark:border-gray-700 flex flex-col justify-between flex-shrink-0 z-20 relative">
        <div class="flex-1 flex flex-col">
            <div class="h-20 flex items-center px-6 border-b border-gray-100 dark:border-gray-700 flex-shrink-0">
                <div class="flex items-center gap-3 w-full justify-center">
                    <img src="/assets/images/shubham-logo.png" alt="Shubham Logo" class="h-12 w-auto object-contain">
                </div>
            </div>
            <nav class="p-4 space-y-1 flex-1 overflow-y-auto">
                <a class="flex items-center px-4 py-3 text-text-sub-light dark:text-text-sub-dark hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-colors"
                    href="/admin/dashboard.html">
                    <span class="material-icons-outlined mr-3">dashboard</span>
                    Dashboard
                </a>
                <a class="flex items-center px-4 py-3 bg-secondary dark:bg-blue-900/40 text-primary dark:text-blue-300 rounded-lg font-medium transition-colors shadow-sm"
                    href="/admin/tickets.html">
                    <span class="material-icons-outlined mr-3">confirmation_number</span>
                    Tickets
                </a>
                <a class="flex items-center px-4 py-3 text-text-sub-light dark:text-text-sub-dark hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-colors"
                    href="/admin/employees.html">
                    <span class="material-icons-outlined mr-3">people</span>
                    Employees
                </a>
                <a class="flex items-center px-4 py-3 text-text-sub-light dark:text-text-sub-dark hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-colors"
                    href="/admin/projects.html">
                    <span class="material-icons-outlined mr-3">folder</span>
                    Projects
                </a>
                <a class="flex items-center px-4 py-3 text-text-sub-light dark:text-text-sub-dark hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-colors"
                    href="/admin/announcements.html">
                    <span class="material-icons-outlined mr-3">campaign</span>
                    Announcements
                </a>
                <a class="flex items-center px-4 py-3 text-text-sub-light dark:text-text-sub-dark hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-colors"
                    href="/admin/settings.html">
                    <span class="material-icons-outlined mr-3">settings</span>
                    Settings
                </a>
            </nav>
        </div>
        <div class="p-4 border-t border-gray-200 dark:border-gray-700">
            <button onclick="logout()"
                class="w-full flex items-center justify-center px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors">
                <span class="material-icons-outlined mr-2 text-sm">logout</span>
                Logout
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <!-- Header -->
        <header
            class="h-20 bg-surface-light dark:bg-surface-dark border-b border-gray-200 dark:border-gray-700 flex items-center justify-between px-8 flex-shrink-0 z-10">
            <div>
                <h1 class="text-lg font-bold text-gray-900 dark:text-white">Tickets Management</h1>
                <p class="text-xs text-text-sub-light dark:text-text-sub-dark hidden sm:block">Manage and track all
                    support tickets</p>
            </div>
            <div class="flex items-center space-x-6">
                <button onclick="toggleFilters()"
                    class="flex items-center gap-2 px-4 py-2 bg-primary hover:bg-blue-800 text-white rounded-lg font-medium transition-colors text-sm">
                    <span class="material-icons-outlined text-sm">filter_list</span>
                    Filters
                </button>
                <div class="flex items-center space-x-3">
                    <span class="text-sm font-medium text-gray-700 dark:text-gray-300 hidden sm:block"
                        id="userName">Admin</span>
                    <div
                        class="h-9 w-9 bg-primary text-white rounded-full flex items-center justify-center text-sm font-medium shadow-sm">
                        <span class="material-icons-outlined text-lg">admin_panel_settings</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto bg-background-light dark:bg-background-dark p-6 md:p-10">
            <!-- Filters -->
            <div id="filtersPanel"
                class="hidden bg-surface-light dark:bg-surface-dark rounded-2xl shadow-sm p-6 border border-gray-100 dark:border-gray-700 mb-6">
                <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center">
                    <span class="material-icons-outlined mr-2 text-primary">tune</span>
                    Filter Tickets
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Search</label>
                        <input type="text" id="searchInput" placeholder="Ticket ID, Employee..."
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                        <select id="statusFilter"
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                            <option value="">All Statuses</option>
                            <option value="Open">Open</option>
                            <option value="Under Review">Under Review</option>
                            <option value="Assigned">Assigned</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Pending">Pending</option>
                            <option value="Resolved">Resolved</option>
                            <option value="Closed">Closed</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Priority</label>
                        <select id="priorityFilter"
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                            <option value="">All Priorities</option>
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                            <option value="Critical">Critical</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Project</label>
                        <select id="projectFilter"
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                            <option value="">All Projects</option>
                        </select>
                    </div>
                </div>
                <div class="flex gap-3 mt-4">
                    <button onclick="loadTickets()"
                        class="px-6 py-2 bg-primary hover:bg-blue-800 text-white rounded-lg font-medium transition-colors text-sm">Apply
                        Filters</button>
                    <button onclick="clearFilters()"
                        class="px-6 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white rounded-lg font-medium transition-colors text-sm">Clear</button>
                </div>
            </div>

            <!-- Tickets Table -->
            <div
                class="bg-surface-light dark:bg-surface-dark rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700">
                            <tr>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                    Ticket ID</th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                    Employee</th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                    Issue Type</th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                    Priority</th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                    Status</th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                    Project</th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                    Created</th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                    Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ticketsTableBody" class="divide-y divide-gray-200 dark:divide-gray-700">
                            <tr>
                                <td colspan="8" class="px-6 py-12 text-center">
                                    <div
                                        class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-primary border-t-transparent">
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pagination -->
            <div id="pagination" class="mt-6 flex justify-center"></div>
        </main>

        <!-- Footer -->
        <footer
            class="bg-surface-light dark:bg-surface-dark border-t border-gray-200 dark:border-gray-700 py-4 px-8 flex-shrink-0">
            <div
                class="flex flex-col md:flex-row items-center justify-between gap-2 text-sm text-text-sub-light dark:text-text-sub-dark">
                <div class="flex items-center gap-1">
                    <span>© 2024</span>
                    <span class="font-semibold text-gray-900 dark:text-white">Shubham EPC Pvt. Ltd.</span>
                    <span>All rights reserved.</span>
                </div>
                <div class="flex items-center gap-1">
                    <span>Powered by</span>
                    <span class="font-semibold text-primary dark:text-blue-400">Helpdesk Pro</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- Update Modal -->
    <div id="updateModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div <div
            class="bg-surface-light dark:bg-surface-dark rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto flex flex-col md:flex-row">
            <!-- Left Side: Ticket Details -->
            <div
                class="p-6 md:p-8 md:w-2/3 border-b md:border-b-0 md:border-r border-gray-200 dark:border-gray-700 overflow-y-auto">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white" id="viewSubject">Subject Here</h3>
                    <span id="viewTicketId"
                        class="px-3 py-1 bg-gray-100 dark:bg-gray-800 rounded-full text-sm font-mono text-gray-600 dark:text-gray-400">#123456</span>
                </div>

                <div class="mb-6">
                    <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                        Description</h4>
                    <p class="text-gray-800 dark:text-gray-200 whitespace-pre-wrap bg-gray-50 dark:bg-gray-800/50 p-4 rounded-lg border border-gray-100 dark:border-gray-700"
                        id="viewDescription">
                        Loading...
                    </p>
                </div>

                <div class="mb-6">
                    <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">
                        Attachments</h4>
                    <div id="viewAttachments" class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                        <!-- Attachments injected here -->
                        <p class="text-gray-500 text-sm italic col-span-full">No attachments.</p>
                    </div>
                </div>

                <div class="flex flex-wrap gap-4 mt-8 pt-6 border-t border-gray-100 dark:border-gray-700 text-sm">
                    <div>
                        <span class="text-gray-500 dark:text-gray-400 block">Employee</span>
                        <span class="font-medium text-gray-900 dark:text-white" id="viewEmployee">John Doe</span>
                    </div>
                    <div>
                        <span class="text-gray-500 dark:text-gray-400 block">Department</span>
                        <span class="font-medium text-gray-900 dark:text-white" id="viewDepartment">IT Support</span>
                    </div>
                    <div>
                        <span class="text-gray-500 dark:text-gray-400 block">Date</span>
                        <span class="font-medium text-gray-900 dark:text-white" id="viewDate">Jan 1, 2024</span>
                    </div>
                </div>
            </div>

            <!-- Right Side: Actions & Update -->
            <div class="p-6 md:w-1/3 bg-gray-50 dark:bg-gray-800/20">
                <div class="flex justify-between items-center mb-6">
                    <h4 class="font-bold text-gray-900 dark:text-white">Update Status</h4>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                        <span class="material-icons-outlined">close</span>
                    </button>
                </div>

                <form id="updateForm" class="space-y-4">
                    <input type="hidden" id="ticketId">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Current
                            Status</label>
                        <select id="statusInput" required
                            class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent cursor-pointer">
                            <option value="Open">Open</option>
                            <option value="Under Review">Under Review</option>
                            <option value="Assigned">Assigned</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Pending">Pending</option>
                            <option value="Resolved">Resolved</option>
                            <option value="Closed">Closed</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Priority</label>
                        <select id="priorityInput"
                            class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent cursor-pointer">
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                            <option value="Critical">Critical</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Admin
                            Comment</label>
                        <textarea id="commentInput" rows="4" placeholder="Add internal note or reply to employee..."
                            class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent text-sm"></textarea>
                    </div>
                    <div class="pt-4">
                        <button type="submit"
                            class="w-full py-3 bg-primary hover:bg-blue-800 text-white rounded-lg font-bold shadow-lg shadow-blue-500/30 transition-all transform hover:-translate-y-0.5">
                            Update Ticket
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    </div>

    <script src="/shared/js/api.js"></script>
    <script>
        if (!checkAuth()) Router.navigate('/admin/');

        const user = Storage.getUser();
        if (!user || user.role !== 'admin') {
            alert('Unauthorized access');
            setTimeout(() => logout(), 2000);
        }

        document.getElementById('userName').textContent = user.name;

        let currentPage = 1;

        function toggleFilters() {
            const panel = document.getElementById('filtersPanel');
            panel.classList.toggle('hidden');
        }

        async function init() {
            try {
                const projects = await ProjectAPI.getAll();
                const projectFilter = document.getElementById('projectFilter');
                projectFilter.innerHTML = '<option value="">All Projects</option>' +
                    projects.data.map(p => `<option value="${p._id}">${p.name}</option>`).join('');
                loadTickets();
            } catch (error) {
                alert('Error loading data');
            }
        }

        async function loadTickets() {
            try {
                const params = {
                    page: currentPage,
                    limit: 20,
                    search: document.getElementById('searchInput').value,
                    status: document.getElementById('statusFilter').value,
                    priority: document.getElementById('priorityFilter').value,
                    project: document.getElementById('projectFilter').value
                };

                const response = await TicketAPI.getAll(params);
                renderTickets(response.data);
                renderPagination(response.page, response.pages);
            } catch (error) {
                alert('Error loading tickets');
            }
        }

        function renderTickets(tickets) {
            const tbody = document.getElementById('ticketsTableBody');

            if (!tickets || tickets.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="px-6 py-12 text-center text-gray-500 dark:text-gray-400">No tickets found</td></tr>';
                return;
            }

            tbody.innerHTML = tickets.map(ticket => `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                    <td class="px-6 py-4">
                        <span class="font-semibold text-primary">${ticket.ticketId}</span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm font-medium text-gray-900 dark:text-white">${ticket.employeeName}</div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">${ticket.employeeId}</div>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-700 dark:text-gray-300">${ticket.issueType || 'N/A'}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${getPriorityClass(ticket.priority)}">${ticket.priority}</span>
                    </td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${getStatusClass(ticket.status)}">${ticket.status}</span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-700 dark:text-gray-300">${ticket.project?.name || 'N/A'}</td>
                    <td class="px-6 py-4 text-xs text-gray-500 dark:text-gray-400">${new Date(ticket.createdAt).toLocaleDateString()}</td>
                    <td class="px-6 py-4">
                        <button onclick='openUpdateModal(${JSON.stringify(ticket).replace(/'/g, "&#39;")})' class="px-3 py-1 bg-primary hover:bg-blue-800 text-white rounded text-xs font-medium transition-colors">
                            Update
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function renderPagination(page, totalPages) {
            const paginationDiv = document.getElementById('pagination');
            if (totalPages <= 1) {
                paginationDiv.innerHTML = '';
                return;
            }

            let html = '<div class="flex gap-2">';

            if (page > 1) {
                html += `<button onclick="changePage(${page - 1})" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white rounded-lg text-sm font-medium transition-colors">← Prev</button>`;
            }

            for (let i = Math.max(1, page - 2); i <= Math.min(totalPages, page + 2); i++) {
                html += `<button onclick="changePage(${i})" class="px-4 py-2 ${i === page ? 'bg-primary text-white' : 'bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white'} rounded-lg text-sm font-medium transition-colors">${i}</button>`;
            }

            if (page < totalPages) {
                html += `<button onclick="changePage(${page + 1})" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white rounded-lg text-sm font-medium transition-colors">Next →</button>`;
            }

            html += '</div>';
            paginationDiv.innerHTML = html;
        }

        function changePage(page) {
            currentPage = page;
            loadTickets();
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('priorityFilter').value = '';
            document.getElementById('projectFilter').value = '';
            currentPage = 1;
            loadTickets();
        }

        function openUpdateModal(ticket) {
            document.getElementById('ticketId').value = ticket._id;
            document.getElementById('statusInput').value = ticket.status;
            document.getElementById('priorityInput').value = ticket.priority;
            document.getElementById('commentInput').value = '';

            // Populate View Details
            document.getElementById('viewSubject').textContent = ticket.subject || 'No Subject';
            document.getElementById('viewTicketId').textContent = ticket.ticketId;
            document.getElementById('viewDescription').textContent = ticket.description;
            document.getElementById('viewEmployee').textContent = ticket.employeeName;
            document.getElementById('viewDepartment').textContent = ticket.issueType;
            document.getElementById('viewDate').textContent = new Date(ticket.createdAt).toLocaleDateString();

            // Populate Attachments
            const attachmentsContainer = document.getElementById('viewAttachments');
            if (ticket.attachments && ticket.attachments.length > 0) {
                attachmentsContainer.innerHTML = ticket.attachments.map(att => `
                    <a href="/${att.path}" target="_blank" class="block group relative rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700 aspect-square bg-gray-100">
                        <img src="/${att.path}" alt="${att.originalName}" class="w-full h-full object-cover transition-transform group-hover:scale-110" onerror="this.src='/assets/images/file_placeholder.png'">
                        <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                            <span class="material-icons-outlined text-white">visibility</span>
                        </div>
                    </a>
                `).join('');
            } else {
                attachmentsContainer.innerHTML = '<p class="text-gray-500 text-sm italic col-span-full">No attachments.</p>';
            }

            document.getElementById('updateModal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('updateModal').classList.add('hidden');
        }

        document.getElementById('updateForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            try {
                const formData = new FormData();
                formData.append('status', document.getElementById('statusInput').value);
                formData.append('priority', document.getElementById('priorityInput').value);
                formData.append('comment', document.getElementById('commentInput').value);

                await TicketAPI.update(document.getElementById('ticketId').value, formData);

                alert('Ticket updated successfully');
                closeModal();
                loadTickets();
            } catch (error) {
                alert('Error updating ticket');
            }
        });

        function getStatusClass(status) {
            const classes = {
                'Open': 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300',
                'Under Review': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300',
                'Assigned': 'bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300',
                'In Progress': 'bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300',
                'Pending': 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300',
                'Resolved': 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300',
                'Closed': 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'
            };
            return classes[status] || classes['Open'];
        }

        function getPriorityClass(priority) {
            const classes = {
                'Low': 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300',
                'Medium': 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300',
                'High': 'bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300',
                'Critical': 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300'
            };
            return classes[priority] || classes['Medium'];
        }

        // Logout function
        function logout() {
            Storage.clear();
            Router.navigate('/admin/');
        }

        init();
    </script>
</body>

</html>